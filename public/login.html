<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n-key="login_page_title">Challenge 0: Obtain Access Token</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/css/styles.css">
    <style>
        /* Keep minimal custom styles, prefer Bootstrap */
        .error-box {
            /* Will be replaced by Bootstrap alerts */
        }
        .highlight-box {
            /* Will be replaced by Bootstrap .alert or custom styled cards */
        }
    </style>
</head>
<body class="bg-dark text-light">
    <div class="position-fixed top-0 end-0 p-3 z-3">
        <button class="btn btn-sm btn-outline-light me-1" onclick="setLanguage('en'); return false;">EN</button>
        <button class="btn btn-sm btn-outline-light" onclick="setLanguage('es'); return false;">ES</button>
    </div>

    <div class="container py-4">
        <div class="text-center mb-4">
            <img src="/img/hida-logo.png" alt="4Geeks Logo" style="max-width: 100px;" />
        </div>

        <div id="loginFeedbackArea" class="mb-3"></div> <!-- Area for authentication feedback - Bootstrap alerts will go here -->

        <h1 data-i18n-key="login_page_title" class="display-5 fw-bold text-center mb-4">Challenge 0: Obtain Your 4Geeks Access Token</h1>
        <p data-i18n-key="login_intro_paragraph" class="lead text-center mb-4">Welcome, prospective 4Geeks Agent! Your first critical task is to gain authorized access to our systems. This requires using <strong>Postman</strong> (or a similar API client) to authenticate with your standard 4Geeks Academy credentials and retrieve an access token.</p>
        
        <div class="alert alert-info small" role="alert">
            <i class="bi bi-info-circle-fill me-2"></i><span data-i18n-key="login_central_api_host_clarification">For the purpose of this CTF, the <code>{{CENTRAL_API_HOST}}</code> you will use is: <strong>https://breathecode.herokuapp.com/v1</strong>. Please use this value when Postman asks for it or when you see <code>{{CENTRAL_API_HOST}}</code> in URLs.</span>
        </div>

        <h2 data-i18n-key="login_instructions_heading" class="h3 mt-5 mb-3">Instructions:</h2>
        <div class="accordion" id="postmanInstructions">
            <div class="accordion-item bg-dark-subtle">
                <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button collapsed bg-dark text-light" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                        <span data-i18n-key="login_step1_launch_postman"><strong>Step 1:</strong> Launch Postman</span>
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#postmanInstructions">
                    <div class="accordion-body">
                        <span data-i18n-key="login_step1_detail">If you don't have Postman, you can download it from <a href="https://www.postman.com/downloads/" target="_blank" rel="noopener noreferrer" class="link-info">postman.com/downloads</a>.</span>
                    </div>
                </div>
            </div>

            <div class="accordion-item bg-dark-subtle">
                <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed bg-dark text-light" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        <span data-i18n-key="login_step2_create_request"><strong>Step 2:</strong> Create a new HTTP Request</span>
                    </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#postmanInstructions">
                    <div class="accordion-body">
                        <ul class="list-unstyled">
                            <li data-i18n-key="login_step2_method"><strong>Method:</strong> <code class="text-warning">POST</code></li>
                            <li>
                                <span data-i18n-key="login_step2_url"><strong>Request URL:</strong> <code class="text-warning">{{CENTRAL_API_HOST}}/v1/auth/login/</code></span>
                                <br>
                                <em class="small text-muted" data-i18n-key="login_step2_url_note">(Remember to replace <code>{{CENTRAL_API_HOST}}</code> with the actual API host: https://breathecode.herokuapp.com/v1)</em>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="accordion-item bg-dark-subtle">
                <h2 class="accordion-header" id="headingThree">
                    <button class="accordion-button collapsed bg-dark text-light" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        <span data-i18n-key="login_step3_configure_body"><strong>Step 3:</strong> Configure the Request Body</span>
                    </button>
                </h2>
                <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#postmanInstructions">
                    <div class="accordion-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item bg-transparent text-light border-secondary" data-i18n-key="login_step3_select_body_tab">Select the <strong>"Body"</strong> tab in Postman.</li>
                            <li class="list-group-item bg-transparent text-light border-secondary" data-i18n-key="login_step3_choose_raw">Choose the <strong>"raw"</strong> option for the body type.</li>
                            <li class="list-group-item bg-transparent text-light border-secondary" data-i18n-key="login_step3_select_json">From the dropdown menu next to "raw", select <strong>"JSON"</strong>.</li>
                            <li class="list-group-item bg-transparent text-light border-secondary">
                                <span data-i18n-key="login_step3_enter_json">In the text area, enter your 4Geeks email and password in the following JSON format:</span>
                                <pre class="bg-black p-2 rounded mt-2 small"><code class="language-json text-white-50">{
    "email": "YOUR_4GEEKS_EMAIL",
    "password": "YOUR_4GEEKS_PASSWORD"
}</code></pre>
                                <em class="small text-muted" data-i18n-key="login_step3_json_example_note">(Replace <code>YOUR_4GEEKS_EMAIL</code> and <code>YOUR_4GEEKS_PASSWORD</code> with your actual credentials.)</em>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="accordion-item bg-dark-subtle">
                <h2 class="accordion-header" id="headingFour">
                    <button class="accordion-button collapsed bg-dark text-light" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                        <span data-i18n-key="login_step4_send_request"><strong>Step 4:</strong> Send the Request</span>
                    </button>
                </h2>
                <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#postmanInstructions">
                    <div class="accordion-body">
                        <span data-i18n-key="login_step4_send_request_detail">Click the "Send" button in Postman.</span>
                    </div>
                </div>
            </div>

            <div class="accordion-item bg-dark-subtle">
                <h2 class="accordion-header" id="headingFive">
                    <button class="accordion-button collapsed bg-dark text-light" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                        <span data-i18n-key="login_step5_inspect_response_title"><strong>Step 5:</strong> Inspect the Response</span>
                    </button>
                </h2>
                <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#postmanInstructions">
                    <div class="accordion-body">
                        <span data-i18n-key="login_step5_inspect_response_detail">If your credentials are correct, the server will return a JSON response. It should look something like this:</span>
                        <pre class="bg-black p-2 rounded mt-2 small"><code class="language-json text-white-50">{
    "token": "1be4ee4f196ab3a6ba4244bfefbaf738fd36a367",
    "user_id": 1,
    "email": "your.email@example.com",
    "expires_at": "YYYY-MM-DDTHH:MM:SS.ssssssZ"
}</code></pre>
                    </div>
                </div>
            </div>

            <div class="accordion-item bg-dark-subtle">
                <h2 class="accordion-header" id="headingSix">
                    <button class="accordion-button collapsed bg-dark text-light" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
                        <span data-i18n-key="login_step6_extract_token"><strong>Step 6:</strong> Extract Your Access Token</span>
                    </button>
                </h2>
                <div id="collapseSix" class="accordion-collapse collapse" aria-labelledby="headingSix" data-bs-parent="#postmanInstructions">
                    <div class="accordion-body">
                        <span data-i18n-key="login_step6_extract_token_detail">The value associated with the <code>"token"</code> key is your 4Geeks Access Token. This is a long string of characters. <strong>Copy this token carefully.</strong></span>
                    </div>
                </div>
            </div>
        </div>


        <h2 data-i18n-key="login_validate_token_heading" class="h3 mt-5 mb-3">Test Your Token (Optional)</h2>
        <div class="token-validator-section card bg-dark-subtle p-3 mb-4">
            <p data-i18n-key="login_validate_token_instructions" class="card-text">Before proceeding, you can optionally validate your obtained token here to ensure it's active and correctly copied.</p>
            <div class="input-group mb-3">
                <span class="input-group-text" data-i18n-key="login_validate_token_label">Token:</span>
                <input type="text" id="tokenInput" name="tokenInput" class="form-control align-self-stretch" placeholder="Paste your token here">
                <button id="validateTokenButton" class="btn btn-outline-info" type="button" data-i18n-key="login_validate_token_button">Validate Token</button>
            </div>
            <div id="validationResult" class="validation-result-area" style="min-height: 2em;">
                <!-- Validation results will be displayed here using Bootstrap alerts -->
            </div>
        </div>

        <h2 data-i18n-key="login_next_steps_heading" class="h3 mt-5 mb-3">Next Steps: Using Your Token</h2>
        <div class="alert alert-warning" role="alert">
            <h4 class="alert-heading h5"><i class="bi bi-exclamation-triangle-fill me-2"></i><span data-i18n-key="login_next_steps_crucial_note_token_title">Crucial Information</span></h4>
            <p class="mb-1"><span data-i18n-key="login_next_steps_crucial_note_token">For all subsequent 4Geeks CTF challenges that involve making API calls (which will be most of them!), you <strong>MUST</strong> include your access token in the HTTP request headers.</span></p>
            <hr>
            <p class="mb-0"><strong data-i18n-key="login_next_steps_header_name">Header Name:</strong> <code class="bg-secondary-subtle p-1 rounded">Authorization</code></p>
            <p class="mb-0"><strong data-i18n-key="login_next_steps_header_value_token">Header Value:</strong> <code class="bg-secondary-subtle p-1 rounded">Token YOUR_ACCESS_TOKEN</code></p>
            <p class="small text-muted mt-1" data-i18n-key="login_next_steps_token_replace_note">(Replace <code>YOUR_ACCESS_TOKEN</code> with the actual token you copied.)</p>
        </div>
        
        <div class="card bg-dark-subtle p-3 mb-4">
            <div class="card-body">
                <h5 class="card-title" data-i18n-key="login_next_steps_web_pages_access_title">Accessing Protected Web Pages</h5>
                <p class="card-text">
                    <span data-i18n-key="login_next_steps_web_pages_info">To access protected <strong>web pages</strong> within this CTF using your browser (like the main dashboard once you're authenticated), you can initiate a session by appending your token as a query parameter to the page's URL <em>once</em>.</span>
                    <span data-i18n-key="login_next_steps_example_intro"> For example:</span>
                    <br>
                    <code class="d-block bg-black p-2 rounded my-2 text-white-50"><span id="dynamicAppUrlBase"></span>/index.html?token=<span data-i18n-key="login_token_placeholder">YOUR_ACCESS_TOKEN</span></code>
                    <span data-i18n-key="login_next_steps_session_cookie_info" class="small text-muted">After doing this, our system will set a session cookie in your browser, and you should be able to navigate other protected pages without re-adding the token to the URL each time.</span>
                </p>
            </div>
        </div>

        <p data-i18n-key="login_conclusion_message" class="text-center my-4">Keep your token secure. You are now ready to proceed with the 4Geeks CTF. Good luck, Agent!</p>
        
        <div class="text-center mb-5">
            <button type="button" class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#dashboardModal">
                <span data-i18n-key="login_button_continue_to_dashboard">Continue to Challenges Dashboard</span> <i class="bi bi-arrow-right-circle-fill ms-2"></i>
            </button>
        </div>

    </div>

    <!-- Modal for proceeding to dashboard -->
    <div class="modal fade" id="dashboardModal" tabindex="-1" aria-labelledby="dashboardModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-dark text-light">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title" id="dashboardModalLabel" data-i18n-key="login_modal_title_proceed">Proceed to Challenges Dashboard</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p data-i18n-key="login_modal_intro">You've obtained your token. Here's how to access the dashboard:</p>
                    <ol class="list-group list-group-numbered list-group-flush">
                        <li class="list-group-item bg-transparent text-light border-secondary" data-i18n-key="login_modal_step1_copy_token">1. Make sure you have copied your access token from Postman.</li>
                        <li class="list-group-item bg-transparent text-light border-secondary">
                            <span data-i18n-key="login_modal_step2_navigate_url_part1">2. In your browser, go to the following URL, replacing</span>
                            <code class="text-info"><span data-i18n-key="login_modal_token_placeholder_in_url">YOUR_TOKEN_HERE</span></code>
                            <span data-i18n-key="login_modal_step2_navigate_url_part2">with your actual token:</span><br>
                            <code class="d-block bg-black p-2 rounded my-1 text-white-50 text-break"><span id="dynamicDashboardUrlBase"></span>/index.html?token=<span data-i18n-key="login_modal_token_placeholder_in_url">YOUR_TOKEN_HERE</span></code>
                        </li>
                        <li class="list-group-item bg-transparent text-light border-secondary" data-i18n-key="login_modal_step3_session_established">3. This will log you in and take you to the dashboard.</li>
                    </ol>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n-key="login_modal_button_close">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="/js/i18n.js"></script> 
    <script src="/js/token-validator.js"></script>
    <script src="/js/login-feedback.js"></script>
    <script src="/js/login-dynamic-url.js"></script>
    <!-- login-modal.js might be less needed if Bootstrap handles modal via data attributes, but check its content -->
    <script src="/js/login-modal.js"></script> 
</body>
</html> 